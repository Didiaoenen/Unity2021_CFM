local TargetProxyBase = require("LuaFramework.Binding.Proxy.Targets.TargetProxyBase")
local IProxyInvoker = require("LuaFramework.Binding.Reflection.IProxyInvoker")
local IObtainable = require("LuaFramework.Binding.Proxy.IObtainable")
local BindingMode = require("LuaFramework.Binding.BindingMode")

local MethodTargetProxy = class("MethodTargetProxy", TargetProxyBase, IObtainable, IProxyInvoker)

function MethodTargetProxy.get:DefaultMode()
   return BindingMode.OneWayToSource
end

function MethodTargetProxy.get:ProxyMethodInfo()
   return self.methodInfo
end

function MethodTargetProxy:ctor(target, methodInfo)
   TargetProxyBase.ctor(self, target)
   IObtainable.ctor(self)
   IProxyInvoker.ctor(self)
   self.methodInfo = methodInfo
end

function MethodTargetProxy:GetValue()
   return self
end

function MethodTargetProxy:Invoke(sender, ...)
   local target = self.target
   if nil == target then
      return
   end

   local functionType = classget(target, self.methodInfo)
   functionType(target, sender, ...)
end

function MethodTargetProxy:dtor()
end

return MethodTargetProxy
