local ITargetProxyFactory = require("LuaFramework.Binding.Proxy.Targets.ITargetProxyFactory")
local FieldOrPropertyTargetProxy = require("LuaFramework.Binding.Proxy.Targets.Universal.FieldOrPropertyTargetProxy")
local InteractionTargetProxy = require("LuaFramework.Binding.Proxy.Targets.Universal.InteractionTargetProxy")
local MethodTargetProxy = require("LuaFramework.Binding.Proxy.Targets.Universal.MethodTargetProxy")
local IInteractionAction = require("LuaFramework.Interactivity.IInteractionAction")

local UniversalTargetProxyFactory = class("UniversalTargetProxyFactory", ITargetProxyFactory)

function UniversalTargetProxyFactory:ctor()

end

function UniversalTargetProxyFactory:CreateProxy(target, description)
   local memberInfo = classget(target, description.TargetName)

   if "userdata" == type(memberInfo) then
      return FieldOrPropertyTargetProxy.new(target, description.TargetName)
   end

   if "function" == type(memberInfo) then
      return MethodTargetProxy.new(target, description.TargetName)
   end

   if "table" == type(memberInfo) then
      if (memberInfo).is(IInteractionAction) then
         return InteractionTargetProxy.new(target, description.TargetName)
      end
   end

   return FieldOrPropertyTargetProxy.new(target, description.TargetName)
end

function UniversalTargetProxyFactory:dtor()
end

return UniversalTargetProxyFactory
