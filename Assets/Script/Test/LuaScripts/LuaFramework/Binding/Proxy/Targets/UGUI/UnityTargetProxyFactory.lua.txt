local Miscellaneous = require("LuaFramework.Common.Miscellaneous")
local ITargetProxyFactory = require("LuaFramework.Binding.Proxy.Targets.ITargetProxyFactory")
local UnityFieldOrPropertyProxy = require("LuaFramework.Binding.Proxy.Targets.UGUI.UnityFieldOrPropertyProxy")
local UnityEventProxy = require("LuaFramework.Binding.Proxy.Targets.UGUI.UnityEventProxy")

local UnityTargetProxyFactory = class("UnityTargetProxyFactory", ITargetProxyFactory)

function UnityTargetProxyFactory:ctor()

end

function UnityTargetProxyFactory:CreateProxy(target, description)
   local memberInfo = classget(target, description.TargetName)

   local updateTrigger = nil
   if nil ~= description.UpdateTrigger and "" ~= description.UpdateTrigger then
      updateTrigger = classget(target, description.UpdateTrigger)

      if nil == updateTrigger then
         return
      end
   end

   if "userdata" == type(memberInfo) then
      if Miscellaneous.CSType.UnityEventBaseT:IsAssignableFrom((memberInfo):GetType()) then
         return UnityEventProxy.new(target, description.TargetName)
      end
   end

   return UnityFieldOrPropertyProxy.new(target, description.TargetName, description.UpdateTrigger)
end

function UnityTargetProxyFactory:dtor()
end

return UnityTargetProxyFactory
