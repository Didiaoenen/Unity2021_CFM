local DefaultUIViewLocator = class("DefaultUIViewLocator")

function DefaultUIViewLocator:ctor()
    
end

function DefaultUIViewLocator:__singleton()
    return DefaultUIViewLocator.new()
end

function DefaultUIViewLocator:LoadAsync(name, type)
    local result = CSharpType.Asynchronous[CSharpTypeName.ProgressResult_1_Single](true)
    Executors:RunOnCoroutineNoReturn(Coroutine.GetEnumerator(function ()
        self:DoLoad(result, name, type)
    end))
    return result
end

function DefaultUIViewLocator:DoLoad(promise, name, type)
    promise:UpdateProgress(0)
    local request = CSharpType.Resources.LoadAsync(name, type)
    while not request.isDone do
        promise:UpdateProgress(request.progress)
        Coroutine.Wait(3)
    end

    local ins = CSharpType.Object.Instantiate(request.asset)
    ins.name = name

    promise:UpdateProgress(1)
    promise:SetResult(ins)
end

function DefaultUIViewLocator:dtor()
    
end

return DefaultUIViewLocator